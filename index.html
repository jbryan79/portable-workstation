<!DOCTYPE html>
<html lang="en" class="theme-dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Portable Workstation</title>

  <!-- TAILWIND CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- TAILWIND CONFIG EXTENSIONS -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            neon: "#0ff"
          }
        }
      }
    };
  </script>

  <!-- YOUR CUSTOM CHAT + THEME CSS VARIABLES -->
  <style>
    :root {
      --chat-bg: #ffffff;
      --chat-text: #111;
      --chat-border: #ddd;
      --chat-user-bg: #2563eb;
      --chat-user-text: #fff;
      --chat-bot-bg: #f3f4f6;
      --chat-bot-text: #111;
    }

    .theme-dark {
      --chat-bg: #1f2937;
      --chat-text: #fff;
      --chat-border: #374151;
      --chat-user-bg: #3b82f6;
      --chat-user-text: #fff;
      --chat-bot-bg: #374151;
      --chat-bot-text: #fff;
      background: #0d0d0d;
      color: white;
    }

    .theme-light {
      --chat-bg: #ffffff;
      --chat-text: #000;
      --chat-border: #ddd;
      --chat-user-bg: #2563eb;
      --chat-user-text: #fff;
      --chat-bot-bg: #f3f4f6;
      --chat-bot-text: #000;
      background: #f5f5f5;
      color: #000;
    }

    .theme-neon {
      --chat-bg: #000;
      --chat-text: #0ff;
      --chat-border: #0ff8;
      --chat-user-bg: #ff00ff;
      --chat-user-text: #000;
      --chat-bot-bg: #00ffff33;
      --chat-bot-text: #0ff;
      background: #000;
      color: #0ff;
    }
  </style>
</head>

<body class="min-h-screen">

  <!-- HEADER -->
  <header class="p-6 flex justify-between items-center">
    <h1 class="text-3xl font-bold">Portable Workstation</h1>

    <!-- THEME SELECTOR -->
    <select id="themeSelector"
      class="px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white">
      <option value="theme-dark">Dark</option>
      <option value="theme-light">Light</option>
      <option value="theme-neon">Neon</option>
    </select>
  </header>

  <!-- HERO -->
  <section class="text-center py-20">
    <h2 class="text-5xl font-bold mb-4">Build Your Perfect Portable Rig</h2>
    <p class="text-lg opacity-80">AI-powered advice. Tailored product picks. Zero fluff.</p>
  </section>

  <!-- PRODUCT GRID -->
  <section id="productGrid" class="grid grid-cols-1 md:grid-cols-3 gap-6 p-6">
    <!-- JS will populate product cards -->
  </section>

  <!-- AI CHAT BUTTON -->
  <button id="aiChatToggle"
    class="fixed bottom-5 right-5 p-4 rounded-full shadow-lg transition"
    style="background: var(--chat-user-bg); color: var(--chat-user-text);">
    ðŸ’¬
  </button>

  <!-- AI CHAT WINDOW -->
  <div id="aiChatWindow"
    class="fixed bottom-24 right-5 w-80 rounded-xl shadow-xl p-4 hidden border"
    style="background: var(--chat-bg); border-color: var(--chat-border); color: var(--chat-text);">

    <div class="font-bold mb-2">AI Shopping Assistant</div>

    <div id="aiChatMessages"
      class="h-64 overflow-y-auto p-2 rounded-lg text-sm space-y-3"
      style="background: var(--chat-bot-bg); border: 1px solid var(--chat-border);">
    </div>

    <div class="flex mt-3">
      <input id="aiChatInput"
        class="flex-1 p-2 rounded-l-lg border"
        style="background: var(--chat-bg); border-color: var(--chat-border); color: var(--chat-text);"
        placeholder="Ask what to buy next..." />

      <button id="aiChatSend"
        class="px-4 rounded-r-lg"
        style="background: var(--chat-user-bg); color: var(--chat-user-text);">
        Send
      </button>
    </div>
  </div>

  <!-- MAIN SCRIPT -->
  <script>
    // THEME SWITCHER
    const themeSelector = document.getElementById("themeSelector");
    themeSelector.addEventListener("change", (e) => {
      document.documentElement.className = e.target.value;
    });

    // PRODUCT DATA
    const products = [
      {
        name: "Your Laptop",
        price: "$999",
        img: "https://via.placeholder.com/300",
        link: "#"
      }
    ];

    // LOAD PRODUCT CARDS
    const productGrid = document.getElementById("productGrid");
    function loadProducts() {
      productGrid.innerHTML = products.map(p => `
        <div class="p-4 bg-gray-800 rounded-xl shadow-xl">
          <img src="${p.img}" class="rounded-lg mb-4"/>
          <h3 class="text-xl font-bold">${p.name}</h3>
          <p class="text-sm opacity-70">${p.price}</p>
          <a href="${p.link}" target="_blank"
            class="mt-3 inline-block px-4 py-2 bg-blue-600 rounded-lg">
            View
          </a>
        </div>
      `).join("");
    }
    loadProducts();

    // CHAT LOGIC
    const chatWindow = document.getElementById("aiChatWindow");
    const chatToggle = document.getElementById("aiChatToggle");
    const chatSend = document.getElementById("aiChatSend");
    const chatInput = document.getElementById("aiChatInput");
    const chatMessages = document.getElementById("aiChatMessages");

    chatToggle.onclick = () => {
      chatWindow.classList.toggle("hidden");
    };

    chatSend.onclick = async () => {
      const prompt = chatInput.value.trim();
      if (!prompt) return;

      addMessage("user", prompt);
      chatInput.value = "";

      const reply = await askAI(prompt);
      addMessage("bot", reply);
    };

    function addMessage(sender, text) {
      const div = document.createElement("div");
      div.className = sender === "user" ? "text-right" : "text-left";

      div.innerHTML = `
        <span class="inline-block px-3 py-2 rounded-lg"
          style="background: ${sender === "user" ? "var(--chat-user-bg)" : "var(--chat-bot-bg)"};
                 color: ${sender === "user" ? "var(--chat-user-text)" : "var(--chat-bot-text)"};">
          ${text}
        </span>
      `;
      chatMessages.appendChild(div);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    async function askAI(prompt) {
      const res = await fetch("/api/ask", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ prompt })
      });

      const data = await res.json();
      return data.reply;
    }
  </script>

</body>
</html>
